<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EO: mastermind.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000020.html">app</a>&nbsp;/&nbsp;<a class="el" href="dir_000027.html">mastermind</a></div>
<h1>mastermind.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">//-----------------------------------------------------------------------------</span>
00002 <span class="comment">// mastermind.h</span>
00003 <span class="comment">//-----------------------------------------------------------------------------</span>
00004 
00005 <span class="preprocessor">#ifndef mastermind_h</span>
00006 <span class="preprocessor"></span><span class="preprocessor">#define mastermind_h</span>
00007 <span class="preprocessor"></span>
00008 <span class="comment">//-----------------------------------------------------------------------------</span>
00009 
00010 <span class="preprocessor">#include &lt;stdlib.h&gt;</span>               <span class="comment">// exit EXIT_FAILURE</span>
00011 <span class="preprocessor">#include &lt;eoVector.h&gt;</span>             <span class="comment">// eoVectorLength</span>
00012 <span class="preprocessor">#include &lt;eoOp.h&gt;</span>                 <span class="comment">// eoMonOp eoQuadraticOp</span>
00013 <span class="preprocessor">#include &lt;eoInit.h&gt;</span>               <span class="comment">// eoInit</span>
00014 <span class="preprocessor">#include "utils/rnd_generators.h"</span> <span class="comment">// uniform_generator</span>
00015 
00016 <span class="comment">//-----------------------------------------------------------------------------</span>
00017 <span class="comment">// phenotype</span>
00018 <span class="comment">//-----------------------------------------------------------------------------</span>
00019 
00020 <span class="keyword">typedef</span> <span class="keywordtype">float</span> phenotype;
00021 
00022 <span class="comment">//-----------------------------------------------------------------------------</span>
00023 <span class="comment">// genotype</span>
00024 <span class="comment">//-----------------------------------------------------------------------------</span>
00025 
00026 <span class="keyword">typedef</span> std::vector&lt;int&gt; genotype;
00027 
00028 <span class="comment">//-----------------------------------------------------------------------------</span>
00029 <span class="comment">// Chrom</span>
00030 <span class="comment">//-----------------------------------------------------------------------------</span>
00031 
00032 <span class="keyword">typedef</span> <a class="code" href="classeo_vector.html">eoVector&lt;phenotype, int&gt;</a> Chrom;
00033 
00034 <span class="comment">//-----------------------------------------------------------------------------</span>
00035 <span class="comment">// eoChromEvaluator</span>
00036 <span class="comment">//-----------------------------------------------------------------------------</span>
00037 
00038 <span class="comment">// const unsigned points_per_black = 3, points_per_white = 1;</span>
00039 Chrom solution;
00040 
00041 phenotype eoChromEvaluator(<span class="keyword">const</span> Chrom&amp; chrom)
00042 {
00043   Chrom tmp = solution;
00044   <span class="keywordtype">unsigned</span> black = 0, white = 0;
00045 
00046   <span class="comment">// look for blacks</span>
00047   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; chrom.size(); ++i)
00048     <span class="keywordflow">if</span> (chrom[i] == tmp[i])
00049       {
00050         ++black;
00051         tmp[i] = -1;
00052       }
00053 
00054   <span class="comment">// look for whites</span>
00055   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; chrom.size(); ++i)
00056     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> j = 0; j &lt; tmp.size(); ++j)
00057       <span class="keywordflow">if</span> (chrom[i] == tmp[j])
00058         {
00059           ++white;
00060           tmp[j] = -1;
00061           <span class="keywordflow">break</span>;
00062         }
00063 
00064   <span class="comment">//  return black * points_per_black + white * points_per_white;</span>
00065   <span class="keywordflow">return</span> black * chrom.size() + white;
00066 };
00067 
00068 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> default_length = 8;
00069 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> default_colors = 8;
00070 <span class="keyword">const</span> std::string default_solution = <span class="stringliteral">"01234567"</span>;
00071 
00072 
00073 <span class="keywordtype">unsigned</span> num_colors;
00074 
00075 <span class="keywordtype">void</span> init_eoChromEvaluator(<span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; c, <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; l, std::string s)
00076 {
00077   num_colors = c;
00078 
00079   <span class="comment">// check consistency between parameters</span>
00080   <span class="keywordflow">if</span> (s != default_solution)
00081     {
00082       <span class="comment">// check length</span>
00083       <span class="keywordflow">if</span> (l != default_length &amp;&amp; s.size() != l)
00084         {
00085           std::cerr &lt;&lt; <span class="stringliteral">"solution length != length"</span> &lt;&lt; std::endl;
00086           exit(EXIT_FAILURE);
00087         }
00088 
00089       <span class="comment">// check number of colors</span>
00090       <span class="keywordflow">if</span> ((c != default_colors) &amp;&amp; (c &lt; unsigned(*max_element(s.begin(), s.end()) - <span class="charliteral">'0'</span>)))
00091         {
00092           std::cerr &lt;&lt; <span class="stringliteral">"too high color number found!"</span> &lt;&lt; std::endl;
00093           exit(EXIT_FAILURE);
00094         }
00095     }
00096   <span class="keywordflow">else</span>
00097     <span class="keywordflow">if</span> (l != default_length || c != default_colors )
00098       <span class="comment">// generate a random solution</span>
00099       <span class="keywordflow">if</span>(num_colors &lt;= 10)
00100         {
00101           <a class="code" href="classuniform__generator.html">uniform_generator&lt;char&gt;</a> color(<span class="charliteral">'0'</span>, static_cast&lt;char&gt;(<span class="charliteral">'0'</span> + c));
00102           s.resize(l);
00103           generate(s.begin(), s.end(), color);
00104         }
00105 
00106   <span class="comment">// put the solution parameter on the solution chromosome</span>
00107   <span class="keywordflow">if</span> (num_colors &lt;= 10)
00108     {
00109       solution.resize(s.size());
00110       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; solution.size(); ++i)
00111         solution[i] = s[i] - <span class="charliteral">'0'</span>;
00112     }
00113   <span class="keywordflow">else</span>
00114     {
00115       solution.resize(l);
00116       <a class="code" href="classuniform__generator.html">uniform_generator&lt;int&gt;</a> color(0, num_colors);
00117       generate(solution.begin(), solution.end(), color);
00118     }
00119 
00120   solution.<a class="code" href="class_e_o.html#a2">fitness</a>(eoChromEvaluator(solution));
00121 }
00122 
00123 <span class="comment">//-----------------------------------------------------------------------------</span>
00124 <span class="comment">// eoChromInit</span>
00125 <span class="comment">//-----------------------------------------------------------------------------</span>
00126 
00127 <span class="keyword">class </span>eoInitChrom: <span class="keyword">public</span> <a class="code" href="classeo_init.html">eoInit</a>&lt;Chrom&gt;
00128 {
00129 <span class="keyword">public</span>:
00130   <span class="keywordtype">void</span> <a class="code" href="classeo_u_f.html#a1">operator()</a>(Chrom&amp; chrom)
00131   {
00132     <a class="code" href="classuniform__generator.html">uniform_generator&lt;int&gt;</a> color(0, num_colors);
00133     chrom.resize(solution.size());
00134     generate(chrom.begin(), chrom.end(), color);
00135     chrom.<a class="code" href="class_e_o.html#a3">invalidate</a>();
00136   }
00137 };
00138 
00139 <span class="comment">//-----------------------------------------------------------------------------</span>
00140 <span class="comment">// eoChromMutation</span>
00141 <span class="comment">//-----------------------------------------------------------------------------</span>
00142 
00143 <span class="keyword">class </span>eoChromMutation: <span class="keyword">public</span> <a class="code" href="classeo_mon_op.html">eoMonOp</a>&lt;Chrom&gt;
00144 {
00145   <span class="comment">// many operators in one :(</span>
00146   <span class="keywordtype">bool</span> <a class="code" href="classeo_u_f.html#a1">operator()</a>(Chrom&amp; chrom)
00147   {
00148     <a class="code" href="classuniform__generator.html">uniform_generator&lt;unsigned&gt;</a> what(0, 2);
00149     <a class="code" href="classuniform__generator.html">uniform_generator&lt;unsigned&gt;</a> position(0, chrom.size());
00150 
00151     <span class="keywordflow">switch</span>(what())
00152       {
00153       <span class="keywordflow">case</span> 0:
00154         {
00155           <span class="comment">// mutation</span>
00156           <a class="code" href="classuniform__generator.html">uniform_generator&lt;int&gt;</a> color(0, num_colors);
00157           chrom[position()] = color();
00158           <span class="keywordflow">break</span>;
00159         }
00160       <span class="keywordflow">case</span> 1:
00161         {
00162           <span class="comment">// transposition</span>
00163           std::swap(chrom[position()], chrom[position()]);
00164           <span class="keywordflow">break</span>;
00165         }
00166       <span class="keywordflow">default</span>:
00167         {
00168           std::cerr &lt;&lt; <span class="stringliteral">"unknown operator!"</span> &lt;&lt; std::endl;
00169           exit(EXIT_FAILURE);
00170           <span class="keywordflow">break</span>;
00171         }
00172       }
00173 
00174     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00175   }
00176 };
00177 
00178 <span class="comment">//-----------------------------------------------------------------------------</span>
00179 <span class="comment">// eoChromXover</span>
00180 <span class="comment">//-----------------------------------------------------------------------------</span>
00181 
00182 <span class="keyword">class </span>eoChromXover: <span class="keyword">public</span> <a class="code" href="classeo_quad_op.html">eoQuadOp</a>&lt;Chrom&gt;
00183 {
00184 <span class="keyword">public</span>:
00185   <span class="keywordtype">bool</span> <a class="code" href="classeo_b_f.html#a1">operator()</a>(Chrom&amp; chrom1, Chrom&amp; chrom2)
00186   {
00187     <a class="code" href="classuniform__generator.html">uniform_generator&lt;unsigned&gt;</a> position(0, chrom1.size());
00188     swap_ranges(chrom1.begin(), chrom1.begin() + position(), chrom2.begin());
00189     <span class="keywordflow">return</span> <span class="keyword">true</span>;
00190   }
00191 };
00192 
00193 <span class="comment">//-----------------------------------------------------------------------------</span>
00194 
00195 <span class="preprocessor">#endif // mastermind_h</span>
00196 <span class="preprocessor"></span>
00197 <span class="comment">// Local Variables:</span>
00198 <span class="comment">// mode:C++</span>
00199 <span class="comment">// End:</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 05:06:41 2006 for EO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
