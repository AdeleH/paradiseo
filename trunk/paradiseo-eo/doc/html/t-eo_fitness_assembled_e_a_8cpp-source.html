<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EO: t-eoFitnessAssembledEA.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000002.html">test</a></div>
<h1>t-eoFitnessAssembledEA.cpp</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">// -*- mode: c++; c-indent-level: 4; c++-member-init-indent: 8; comment-column: 35; -*-</span>
00002  
00003 <span class="comment">//-----------------------------------------------------------------------------</span>
00004 <span class="comment">// t-eoFitnessAssembledEA.cpp</span>
00005 <span class="comment">// Marc Wintermantel &amp; Oliver Koenig</span>
00006 <span class="comment">// IMES-ST@ETHZ.CH</span>
00007 <span class="comment">// March 2003</span>
00008 
00009 <span class="comment">/*</span>
00010 <span class="comment">    This library is free software; you can redistribute it and/or</span>
00011 <span class="comment">    modify it under the terms of the GNU Lesser General Public</span>
00012 <span class="comment">    License as published by the Free Software Foundation; either</span>
00013 <span class="comment">    version 2 of the License, or (at your option) any later version.</span>
00014 <span class="comment"> </span>
00015 <span class="comment">    This library is distributed in the hope that it will be useful,</span>
00016 <span class="comment">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00017 <span class="comment">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU</span>
00018 <span class="comment">    Lesser General Public License for more details.</span>
00019 <span class="comment"> </span>
00020 <span class="comment">    You should have received a copy of the GNU Lesser General Public</span>
00021 <span class="comment">    License along with this library; if not, write to the Free Software</span>
00022 <span class="comment">    Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00023 <span class="comment"> </span>
00024 <span class="comment">    Contact: todos@geneura.ugr.es, http://geneura.ugr.es</span>
00025 <span class="comment">             Marc.Schoenauer@inria.fr</span>
00026 <span class="comment">             mak@dhi.dk</span>
00027 <span class="comment">*/</span>
00028 <span class="comment">//-----------------------------------------------------------------------------</span>
00029 <span class="preprocessor">#ifdef HAVE_CONFIG_H</span>
00030 <span class="preprocessor"></span><span class="preprocessor">#include &lt;config.h&gt;</span>
00031 <span class="preprocessor">#endif</span>
00032 <span class="preprocessor"></span>
00033 <span class="preprocessor">#include &lt;iostream&gt;</span>
00034 <span class="preprocessor">#include &lt;cmath&gt;</span>
00035 
00036 <span class="comment">// General eo includes</span>
00037 <span class="preprocessor">#include &lt;eo&gt;</span>
00038 <span class="preprocessor">#include &lt;utils/eoRealVectorBounds.h&gt;</span>   <span class="comment">// The real bounds (not yet in general eo include)</span>
00039 
00040 <span class="comment">// Representation dependent includes and typedefs</span>
00041 <span class="preprocessor">#include &lt;es/eoReal.h&gt;</span>                  <span class="comment">// Definition of representation</span>
00042 <span class="preprocessor">#include &lt;es/eoRealInitBounded.h&gt;</span>       <span class="comment">// Uniformly initializes real vector in bounds</span>
00043 <span class="preprocessor">#include &lt;es/make_genotype_real.h&gt;</span>              <span class="comment">// Initialization of a genotype</span>
00044 <span class="preprocessor">#include &lt;eoEvalFunc.h&gt;</span>                 <span class="comment">// Base class for fitness evaluation </span>
00045 <span class="preprocessor">#include &lt;es/make_op_real.h&gt;</span>            <span class="comment">// Variation operators using standard Real operators</span>
00046 <span class="preprocessor">#include &lt;eoScalarFitnessAssembled.h&gt;</span>     <span class="comment">// The fitness class</span>
00047 <span class="keyword">typedef</span> <a class="code" href="classeo_real.html">eoReal&lt;eoAssembledMinimizingFitness&gt;</a> <a class="code" href="classeo_real.html">Indi</a>;
00048 
00049 <span class="comment">// Representation independent modules</span>
00050 <span class="preprocessor">#include &lt;do/make_pop.h&gt;</span>                <span class="comment">// Initialization of population</span>
00051 <span class="preprocessor">#include &lt;do/make_continue.h&gt;</span>           <span class="comment">// The stopping criterion</span>
00052 <span class="preprocessor">#include &lt;do/make_checkpoint_assembled.h&gt;</span>       <span class="comment">// Outputs (stats, population dumps, ...)</span>
00053 <span class="preprocessor">#include &lt;do/make_algo_scalar.h&gt;</span>        <span class="comment">// Evolution engine (selection and replacement)</span>
00054 <span class="preprocessor">#include &lt;do/make_run.h&gt;</span>                <span class="comment">// simple call to the algo.stays there for consistency reasons </span>
00055 
00056 <span class="comment">// Define a fitness class</span>
00057 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EOT&gt;
00058 <span class="keyword">class </span>eoAssembledEvalFunc : <span class="keyword">public</span> <a class="code" href="classeo_eval_func.html">eoEvalFunc</a>&lt;EOT&gt;{
00059 <span class="keyword">public</span>:
00060   <span class="comment">// Constructor defining number and descriptions of fitness terms</span>
00061   eoAssembledEvalFunc() {
00062     
00063     <span class="comment">// Define a temporary fitness object to have access to its static traits</span>
00064     <span class="keyword">typename</span> EOT::Fitness tmpfit(3, 0.0);    
00065     tmpfit.setDescription(0,<span class="stringliteral">"Fitness"</span>);
00066     tmpfit.setDescription(1,<span class="stringliteral">"Some Value"</span>);
00067     tmpfit.setDescription(2,<span class="stringliteral">"Other Value"</span>);
00068 
00069   }
00070 
00071   <span class="keywordtype">void</span> <a class="code" href="classeo_u_f.html#a1">operator()</a>(<a class="code" href="struct_dummy.html">EOT</a>&amp; _eo){
00072 
00073     <span class="comment">// Define temporary fitness object </span>
00074     <span class="comment">// (automatically gets initialized with size given in constructor)</span>
00075     <span class="keyword">typename</span> EOT::Fitness tmpfit;
00076     
00077     <span class="comment">// Eval some dummy fitness</span>
00078     <span class="keywordtype">double</span> sum1=0.0, sum2=0.0;
00079     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i=0; i &lt; _eo.size(); ++i){
00080       sum1 += _eo[i]*_eo[i];
00081       sum2 += fabs(_eo[i]) + fabs(_eo[i]);
00082     }
00083     
00084     <span class="comment">// Store some fitness terms</span>
00085     tmpfit[1]= sum1;
00086     tmpfit[2]= sum2;
00087     
00088     <span class="comment">// Store the fitness</span>
00089     tmpfit = (sum1 + sum2)/_eo.size();
00090 
00091     <span class="comment">// Pass it</span>
00092     _eo.<a class="code" href="class_e_o.html#a2">fitness</a>( tmpfit );
00093   
00094   }
00095 };
00096 
00097 <span class="comment">// checks for help demand, and writes the status file and make_help; in libutils</span>
00098 <span class="keywordtype">void</span> make_help(<a class="code" href="classeo_parser.html">eoParser</a> &amp; _parser);
00099 
00100 <span class="comment">// now use all of the above, + representation dependent things</span>
00101 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[]){
00102   
00103   std::cout &lt;&lt; <span class="stringliteral">"-----------------------------------"</span> &lt;&lt; std::endl;
00104   std::cout &lt;&lt; <span class="stringliteral">"START t-eoFitnessAssembledEA"</span> &lt;&lt; std::endl;
00105 
00106   <span class="keywordflow">try</span>{
00107 
00108     <span class="comment">// Parser &amp; State</span>
00109     <a class="code" href="classeo_parser.html">eoParser</a> parser(argc, argv);  <span class="comment">// for user-parameter reading    </span>
00110     <a class="code" href="classeo_state.html">eoState</a> state;    <span class="comment">// keeps all things allocated</span>
00111 
00113     <span class="comment">// A) Representation dependent stuff</span>
00115 <span class="comment"></span>
00116     <span class="comment">// The fitness</span>
00117     eoAssembledEvalFunc&lt;Indi&gt; plainEval;
00118     <span class="comment">// turn that object into an evaluation counter</span>
00119     <a class="code" href="classeo_eval_func_counter.html">eoEvalFuncCounter&lt;Indi&gt;</a> eval(plainEval);
00120 
00121     <span class="comment">// The genotype</span>
00122     <a class="code" href="classeo_real_init_bounded.html">eoRealInitBounded&lt;Indi&gt;</a>&amp; init = do_make_genotype(parser, state, Indi() );
00123     
00124     <span class="comment">// The variation operators</span>
00125     <a class="code" href="classeo_gen_op.html">eoGenOp&lt;Indi&gt;</a>&amp; op = do_make_op(parser, state, init);
00126 
00128     <span class="comment">// B) Create representation independent stuff</span>
00130 <span class="comment"></span>
00131     <span class="comment">// initialize the population</span>
00132     <span class="comment">// yes, this is representation indepedent once you have an eoInit</span>
00133     <a class="code" href="classeo_pop.html">eoPop&lt;Indi&gt;</a>&amp; pop   = do_make_pop(parser, state, init);
00134 
00135     <span class="comment">// stopping criteria</span>
00136     <a class="code" href="classeo_continue.html">eoContinue&lt;Indi&gt;</a> &amp; term = do_make_continue(parser, state, eval);
00137     <span class="comment">// output</span>
00138     <a class="code" href="classeo_check_point.html">eoCheckPoint&lt;Indi&gt;</a> &amp; checkpoint = do_make_checkpoint_assembled(parser, state, eval, term);
00139     <span class="comment">// algorithm (need the operator!)</span>
00140     <a class="code" href="classeo_algo.html">eoAlgo&lt;Indi&gt;</a>&amp; ga = do_make_algo_scalar(parser, state, eval, checkpoint, op);
00141 
00142 
00143     make_help(parser);  <span class="comment">// To be called after all parameters have been read !</span>
00144 
00146     <span class="comment">// C) Run the algorithm</span>
00148 <span class="comment"></span>
00149     <span class="comment">// evaluate intial population AFTER help and status in case it takes time</span>
00150     apply&lt;Indi&gt;(eval, pop);
00151     <span class="comment">// if you want to print it out</span>
00152     std::cout &lt;&lt; <span class="stringliteral">"Initial Population\n"</span>;
00153     pop.<a class="code" href="classeo_pop.html#a17">sortedPrintOn</a>(std::cout);
00154     std::cout &lt;&lt; std::endl;
00155 
00156     do_run(ga, pop); <span class="comment">// run the ga</span>
00157 
00158     std::cout &lt;&lt; <span class="stringliteral">"Final Population\n"</span>;
00159     pop.<a class="code" href="classeo_pop.html#a17">sortedPrintOn</a>(std::cout);
00160     std::cout &lt;&lt; std::endl;
00161     
00162   }
00163   <span class="keywordflow">catch</span>(std::exception&amp; e)
00164     {
00165       std::cout &lt;&lt; e.what() &lt;&lt; std::endl;
00166       <span class="keywordflow">return</span> 1;
00167     }
00168 
00169   std::cout &lt;&lt; <span class="stringliteral">"-----------------------------------"</span> &lt;&lt; std::endl;
00170   std::cout &lt;&lt; <span class="stringliteral">"END t-eoFitnessAssembledEA"</span> &lt;&lt; std::endl;
00171 
00172   <span class="keywordflow">return</span> 0;
00173 
00174 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 05:06:43 2006 for EO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
