<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EO: eoSymEval.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000007.html">contrib</a>&nbsp;/&nbsp;<a class="el" href="dir_000008.html">mathsym</a>&nbsp;/&nbsp;<a class="el" href="dir_000018.html">eo_interface</a></div>
<h1>eoSymEval.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">/*          </span>
00002 <span class="comment"> *             Copyright (C) 2005 Maarten Keijzer</span>
00003 <span class="comment"> *</span>
00004 <span class="comment"> *          This program is free software; you can redistribute it and/or modify</span>
00005 <span class="comment"> *          it under the terms of version 2 of the GNU General Public License as </span>
00006 <span class="comment"> *          published by the Free Software Foundation. </span>
00007 <span class="comment"> *</span>
00008 <span class="comment"> *          This program is distributed in the hope that it will be useful,</span>
00009 <span class="comment"> *          but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00010 <span class="comment"> *          MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00011 <span class="comment"> *          GNU General Public License for more details.</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> *          You should have received a copy of the GNU General Public License</span>
00014 <span class="comment"> *          along with this program; if not, write to the Free Software</span>
00015 <span class="comment"> *          Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307  USA</span>
00016 <span class="comment"> */</span>
00017 
00018 <span class="preprocessor">#ifndef SYMEVAL_H</span>
00019 <span class="preprocessor"></span><span class="preprocessor">#define SYMEVAL_H</span>
00020 <span class="preprocessor"></span>
00021 <span class="preprocessor">#include &lt;Sym.h&gt;</span>
00022 <span class="preprocessor">#include &lt;FunDef.h&gt;</span>
00023 <span class="preprocessor">#include &lt;ErrorMeasure.h&gt;</span>
00024 <span class="preprocessor">#include &lt;BoundsCheck.h&gt;</span>
00025 
00026 <span class="preprocessor">#include &lt;eoPopEvalFunc.h&gt;</span>
00027 
00028 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EoType&gt;
00029 <span class="keyword">class </span>eoSymPopEval : <span class="keyword">public</span> <a class="code" href="classeo_pop_eval_func.html">eoPopEvalFunc</a>&lt;EoType&gt; {
00030 
00031     BoundsCheck&amp;  check;
00032     ErrorMeasure&amp; measure;
00033     <span class="keywordtype">unsigned</span> size_cap; 
00034     
00035     <span class="keyword">public</span>:
00036 
00037     eoSymPopEval(BoundsCheck&amp; _check, ErrorMeasure&amp; _measure, <span class="keywordtype">unsigned</span> _size_cap) :
00038         check(_check), measure(_measure), size_cap(_size_cap) {}
00039 
00048     <span class="keywordtype">void</span> <a class="code" href="classeo_b_f.html#a1">operator()</a>(<a class="code" href="classeo_pop.html">eoPop&lt;EoType&gt;</a>&amp; p1, <a class="code" href="classeo_pop.html">eoPop&lt;EoType&gt;</a>&amp; p2) {
00049         
00050         std::vector&lt;unsigned&gt; unevaluated;
00051         std::vector&lt;Sym&gt; tmppop;
00052         
00053         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; p1.size(); ++i) {
00054             <span class="keywordflow">if</span> (p1[i].invalid()) {
00055 
00056                 <span class="keywordflow">if</span> (expand_all(p1[i]).size() &lt; size_cap &amp;&amp; check.in_bounds(p1[i])) {
00057                     unevaluated.push_back(i);
00058                     tmppop.push_back( static_cast&lt;Sym&gt;(p1[i]) );
00059                 } <span class="keywordflow">else</span> {
00060                     p1[i].fitness( measure.worst_performance() );
00061                 }
00062             }
00063         }
00064 
00065         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; p2.size(); ++i) {
00066             <span class="keywordflow">if</span> (p2[i].invalid()) {
00067                 
00068                 <span class="keywordflow">if</span> (expand_all(p2[i]).size() &lt; size_cap &amp;&amp; check.in_bounds(p2[i])) {
00069                     
00070                     unevaluated.push_back(p1.size() + i);
00071                     tmppop.push_back( static_cast&lt;Sym&gt;(p2[i]) );
00072 
00073                 } <span class="keywordflow">else</span> {
00074                     p2[i].fitness( measure.worst_performance() ); <span class="comment">// pretty bad error</span>
00075                 }
00076             }
00077         }
00078 
00079         std::vector&lt;ErrorMeasure::result&gt; result = measure.calc_error(tmppop);
00080 
00081         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; result.size(); ++i) {
00082             <span class="keywordtype">unsigned</span> idx = unevaluated[i];
00083 
00084             <span class="keywordflow">if</span> (idx &lt; p1.size()) {
00085                 p1[idx].fitness(result[i].error);
00086             } <span class="keywordflow">else</span> {
00087                 idx -= p1.size();
00088                 p2[idx].fitness(result[i].error);
00089             }
00090         }
00091     }
00092 
00093 };
00094 
00095 
00096 <span class="preprocessor">#endif</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 05:06:38 2006 for EO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
