<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>EO: make_genotype_real.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.9.1 -->
<div class="qindex">  <form class="search" action="search.php" method="get">
<a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="namespacemembers.html">Namespace&nbsp;Members</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a>  | <span class="search"><u>S</u>earch&nbsp;for&nbsp;<input class="search" type="text" name="query" value="" size="20" accesskey="s"/></span></form></div>
<div class="nav">
<a class="el" href="dir_000000.html">src</a>&nbsp;/&nbsp;<a class="el" href="dir_000010.html">es</a></div>
<h1>make_genotype_real.h</h1><div class="fragment"><pre class="fragment">00001 <span class="comment">//-----------------------------------------------------------------------------</span>
00024 <span class="comment"></span><span class="preprocessor">#ifndef EO_make_genotype_h</span>
00025 <span class="preprocessor"></span><span class="preprocessor">#define EO_make_genotype_h</span>
00026 <span class="preprocessor"></span>
00027 <span class="preprocessor">#include &lt;iostream&gt;</span>
00028 <span class="preprocessor">#include &lt;sstream&gt;</span>
00029 <span class="preprocessor">#include &lt;vector&gt;</span>
00030 
00031 <span class="preprocessor">#include "es/eoReal.h"</span>
00032 <span class="preprocessor">#include "es/eoEsChromInit.h"</span>
00033 <span class="preprocessor">#include "utils/eoParser.h"</span>
00034 <span class="preprocessor">#include "utils/eoRealVectorBounds.h"</span>
00035 <span class="preprocessor">#include "utils/eoState.h"</span>
00036 
00037 
00060 <span class="keyword">template</span> &lt;<span class="keyword">class</span> EOT&gt;
00061 <a class="code" href="classeo_es_chrom_init.html">eoEsChromInit&lt;EOT&gt;</a> &amp; do_make_genotype(<a class="code" href="classeo_parser.html">eoParser</a>&amp; _parser, <a class="code" href="classeo_state.html">eoState</a>&amp; _state, <a class="code" href="struct_dummy.html">EOT</a>)
00062 {
00063     <span class="comment">// the fitness type</span>
00064     <span class="keyword">typedef</span> <span class="keyword">typename</span> EOT::Fitness <a class="code" href="classeo_scalar_fitness.html">FitT</a>;
00065     <a class="code" href="classeo_es_chrom_init.html">eoEsChromInit&lt;EOT&gt;</a> *init;
00066 
00067     <span class="comment">// for eoReal, only thing needed is the size - but might have been created elswhere ...</span>
00068     <a class="code" href="classeo_value_param.html">eoValueParam&lt;unsigned&gt;</a>&amp; vecSize
00069         = _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(<span class="keywordtype">unsigned</span>(10), <span class="stringliteral">"vecSize"</span>,
00070                                    <span class="stringliteral">"The number of variables "</span>,
00071                                    <span class="charliteral">'n'</span>,<span class="stringliteral">"Genotype Initialization"</span>);
00072     <span class="comment">// to build an eoReal Initializer, we need bounds: [-1,1] by default</span>
00073     <a class="code" href="classeo_value_param.html">eoValueParam&lt;eoRealVectorBounds&gt;</a>&amp; boundsParam
00074         = _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(<a class="code" href="classeo_real_vector_bounds.html">eoRealVectorBounds</a>(vecSize.<a class="code" href="classeo_value_param.html#a2">value</a>(), -1, 1),
00075                                    <span class="stringliteral">"initBounds"</span>,
00076                                    <span class="stringliteral">"Bounds for initialization (MUST be bounded)"</span>,
00077                                    <span class="charliteral">'B'</span>, <span class="stringliteral">"Genotype Initialization"</span>);
00078     <span class="comment">// now some initial value for sigmas - even if useless?</span>
00079     <span class="comment">// should be used in Normal mutation</span>
00080     <a class="code" href="classeo_value_param.html">eoValueParam&lt;std::string&gt;</a>&amp; sigmaParam
00081         = _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(std::string(<span class="stringliteral">"0.3"</span>), <span class="stringliteral">"sigmaInit"</span>,
00082                                    <span class="stringliteral">"Initial value for Sigmas (with a '%' -&gt; scaled by the range of each variable)"</span>,
00083                                    <span class="charliteral">'s'</span>,<span class="stringliteral">"Genotype Initialization"</span>);
00084     <span class="comment">// check if there is a vecSigmaInit</span>
00085     <a class="code" href="classeo_param.html">eoParam</a> *vecSigmaParam = _parser.<a class="code" href="classeo_parser.html#a9">getParamWithLongName</a>(<span class="stringliteral">"vecSigmaInit"</span>);
00086     <span class="keywordflow">if</span>(vecSigmaParam) {
00087         <a class="code" href="classeo_value_param.html">eoValueParam&lt;std::vector&lt;double&gt;</a> &gt;&amp; vecSigmaParam
00088             = _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(std::vector&lt;double&gt;(vecSize.<a class="code" href="classeo_value_param.html#a2">value</a>(), 0.3),
00089                                        <span class="stringliteral">"vecSigmaInit"</span>, <span class="stringliteral">"Initial value for Sigma(s)"</span>,
00090                                        <span class="charliteral">'V'</span>,<span class="stringliteral">"Genotype Initialization"</span>);
00091         init = <span class="keyword">new</span> <a class="code" href="classeo_es_chrom_init.html">eoEsChromInit&lt;EOT&gt;</a>(boundsParam.<a class="code" href="classeo_value_param.html#a2">value</a>(), vecSigmaParam.<a class="code" href="classeo_value_param.html#a2">value</a>());
00092     } <span class="keywordflow">else</span> {
00093         <span class="comment">// now some initial value for sigmas - even if useless?</span>
00094         <span class="comment">// should be used in Normal mutation</span>
00095         <a class="code" href="classeo_value_param.html">eoValueParam&lt;std::string&gt;</a>&amp; sigmaParam
00096             = _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(std::string(<span class="stringliteral">"0.3"</span>), <span class="stringliteral">"sigmaInit"</span>,
00097                                        <span class="stringliteral">"Initial value for Sigmas "</span>
00098                                        <span class="stringliteral">"(with '%' scaled by the range of each variable)"</span>,
00099                                        <span class="charliteral">'s'</span>,<span class="stringliteral">"Genotype Initialization"</span>);
00100         <span class="comment">// check for %</span>
00101         <span class="keywordtype">bool</span> to_scale = <span class="keyword">false</span>;
00102         size_t pos =  sigmaParam.<a class="code" href="classeo_value_param.html#a2">value</a>().find(<span class="charliteral">'%'</span>);
00103         <span class="keywordflow">if</span>(pos &lt; sigmaParam.<a class="code" href="classeo_value_param.html#a2">value</a>().size())
00104         {
00105             <span class="comment">//  found a % - use scaling and get rid of '%'</span>
00106             to_scale = <span class="keyword">true</span>;
00107             sigmaParam.<a class="code" href="classeo_value_param.html#a2">value</a>().resize(pos);
00108         }
00109         std::istringstream is(sigmaParam.<a class="code" href="classeo_value_param.html#a2">value</a>());
00110         <span class="keywordtype">double</span> sigma;
00111         is &gt;&gt; sigma;
00112         <span class="comment">// minimum check</span>
00113         <span class="keywordflow">if</span>(sigma &lt; 0)
00114             <span class="keywordflow">throw</span> std::runtime_error(<span class="stringliteral">"Negative sigma in make_genotype"</span>);
00115         init = <span class="keyword">new</span> <a class="code" href="classeo_es_chrom_init.html">eoEsChromInit&lt;EOT&gt;</a>(boundsParam.<a class="code" href="classeo_value_param.html#a2">value</a>(), sigma, to_scale);
00116         <span class="comment">// define parameter</span>
00117         _parser.<a class="code" href="classeo_parser.html#a10">getORcreateParam</a>(std::vector&lt;double&gt;(vecSize.<a class="code" href="classeo_value_param.html#a2">value</a>(), 0.3),
00118                                  <span class="stringliteral">"vecSigmaInit"</span>, <span class="stringliteral">"Initial value for Sigma(s)"</span>,
00119                                  <span class="charliteral">'V'</span>,<span class="stringliteral">"Genotype Initialization"</span>);
00120     }
00121     <span class="comment">// store in state</span>
00122     _state.<a class="code" href="classeo_functor_store.html#a2">storeFunctor</a>(init);
00123     <span class="keywordflow">return</span> *init;
00124 }
00125 
00126 <span class="preprocessor">#endif // EO_make_genotype_h</span>
00127 <span class="preprocessor"></span>
00128 
00129 
00130 <span class="comment">// Local Variables:</span>
00131 <span class="comment">// coding: iso-8859-1</span>
00132 <span class="comment">// mode:C++</span>
00133 <span class="comment">// c-file-style: "Stroustrup"</span>
00134 <span class="comment">// comment-column: 35</span>
00135 <span class="comment">// fill-column: 80</span>
00136 <span class="comment">// End:</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Oct 19 05:06:40 2006 for EO by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.3.9.1 </small></address>
</body>
</html>
